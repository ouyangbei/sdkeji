"use strict";var AV=require("leanengine");var moment=require("moment");var router=require("express").Router();var parseurl=require("parseurl");var session=require("express-session");
var express=require("express");var xss=require("xss");var apis=require("./apis");var requestsql=require("./mysqlrequest");var error=require("./error");
var users=require("./api_users");var app=express();app.use(session({secret:"keyboard cat",resave:false,saveUninitialized:true,cookie:{maxAge:60000}}));
requestsql.init;router.post("/getTopics",function(b,a){});router.post("/newart",function(b,a){newArticle(b,a,function(d,c){users.ResultProcessed(a,d,c);
});});function newArticle(d,b,h){var a=d.session.userId;var g=xss(d.body.data);var e=JSON.parse(g);if(!a){var c="3003";return h({cood:error[c]["3003"],message:error[c]["message"]},null);
}else{e.personInfoId=d.session.userId;}if(!e.type||!e.title||!e.titleImg||!e.topicId||!e.details){if(!e.type){var c="3004";}else{if(!e.title){var c="3005";
}else{if(!e.titleImg){var c="3006";}else{if(!e.topicId){var c="3007";}else{if(!e.details){var c="3008";}}}}}return h({cood:error[c]["code"],message:error[c]["message"]},null);
}else{var f={content:JSON.stringify(e)};requestsql.request(apis.article["newarticle"],f,"form",function(j,i){return h(j,i);});}}module.exports=router;